<% content_for :page_title do %>
  <%= Spree.t(:general_settings) %>
<% end %>

<%= form_tag admin_general_settings_path, method: :put do %>
  <div id="preferences" data-hook>
    <fieldset class="general no-border-top">

      <div class="row">
        <div class="col-12 col-lg-6">
          <%#-------------------------------------------------%>
          <%# Security settings                               %>
          <%#-------------------------------------------------%>
          <% if @preferences_security.any? %>
            <div class="card mb-3" id="general-settings-security" data-hook="general_settings_security">
              <div class="card-header">
                <h1 class="card-title mb-0 h5">
                  <%= Spree.t(:security_settings) %>
                </h1>
              </div>

              <div class="card-body">
                <% @preferences_security.each do |key|
                    type = Spree::Config.preference_type(key) %>
                    <div class="checkbox">
                      <%= label_tag key do %>
                        <%= preference_field_tag(key, Spree::Config[key], type: type) %>
                        <%= Spree.t(key) %>
                      <% end %>
                    </div>
                <% end %>
              </div>
            </div>
          <% end %>

          <%#-------------------------------------------------%>
          <%# Clear cache                                     %>
          <%#-------------------------------------------------%>
          <div class="card mb-3" id="general-settings-cache" data-hook="general_settings_cache">
            <div class="card-header">
              <h1 class="card-title mb-0 h5"><%= Spree.t(:clear_cache) %></h1>
            </div>

            <div class="card-body">
              <div class="clear-cache-warning alert alert-warning">
                <%= Spree.t(:clear_cache_warning) %>
              </div>
              <div data-hook="general_settings_clear_cache">
                <%= button Spree.t(:clear_cache), 'recycle.svg', 'button', id: "clear_cache" %>
              </div>
            </div>
          </div>

        </div>
        <div class="col-12 col-lg-6">

          <%#-------------------------------------------------%>
          <%# Currency Settings                               %>
          <%#-------------------------------------------------%>
          <div class="card mb-3" id="general-settings-currency" data-hook="general_settings_currency">
            <div class="card-header">
              <h1 class="card-title mb-0 h5">
                <%= Spree.t(:currency_settings) %>
              </h1>
            </div>

            <div class="card-body">
              <div class="alert alert-warning col-12">
                This can be overriden by individual Store settings
              </div>
              <div class="form-group">
                <%= label_tag :currency, Spree.t(:default_currency) %>
                <%= select_tag :currency, currency_options, class: 'select2' %>
              </div>
            </div>
          </div>

          <%#-------------------------------------------------%>
          <%# Store Settings                               %>
          <%#-------------------------------------------------%>
          <div class="card mb-3" id="general-settings-stores" data-hook="general_settings_stores">
            <div class="card-header">
              <h1 class="card-title mb-0 h5">
                <%= Spree.t(:multiple_stores) %>
              </h1>
            </div>
            <div class="card-body">
              <div class="alert alert-warning col-12">
                <%= Spree.t('show_store_selector.long') %>
              </div>
              <div class="form-group">
                <div class="checkbox">
                  <label>
                    <%= check_box('', :show_store_selector, { checked: Spree::Config.show_store_selector }) %>
                    <%= Spree.t('show_store_selector.short') %>
                  </label>
                </div>
              </div>
            </div>
          </div>

          <%#-------------------------------------------------%>
          <%# Language Control Settings                               %>
          <%#-------------------------------------------------%>
          <div class="card mb-3" id="general-settings-language-control" data-hook="general_settings_language_control">
            <div class="card-header">
              <h1 class="card-title mb-0 h5">
                <%= Spree.t(:language_control) %>
              </h1>
            </div>
            <div class="card-body">
              <div class="alert alert-warning col-12">
                <%= Spree.t('show_hide_languages.long') %>
              </div>
              <div class="form-group">
                <div class="checkbox">
                  <label>
                    <%= check_box('', :only_show_languages_marked_as_active, { checked: Spree::Config.only_show_languages_marked_as_active }) %>
                    <%= Spree.t('show_hide_languages.short') %>
                  </label>
                </div>
              </div>
              <div class="alert alert-info col-12">
                <%= raw Spree.t('show_hide_languages.more_info') %>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="form-actions" data-hook="buttons">
        <%= button Spree.t('actions.update'), 'save.svg' %>
        <span class="or"><%= Spree.t(:or) %></span>
        <%= button_link_to Spree.t('actions.cancel'), edit_admin_general_settings_url, icon: 'cancel.svg' %>
      </div>

    </fieldset>
  </div>
<% end %>
